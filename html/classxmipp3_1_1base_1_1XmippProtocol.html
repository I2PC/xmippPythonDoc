<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp3.base.XmippProtocol Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v3.23.11-Nereus</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacexmipp3.html">xmipp3</a></li><li class="navelem"><a class="el" href="namespacexmipp3_1_1base.html">base</a></li><li class="navelem"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html">XmippProtocol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classxmipp3_1_1base_1_1XmippProtocol-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">xmipp3.base.XmippProtocol Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for xmipp3.base.XmippProtocol:</div>
<div class="dyncontent">
<div class="center"><img src="classxmipp3_1_1base_1_1XmippProtocol__inherit__graph.png" border="0" usemap="#xmipp3_8base_8XmippProtocol_inherit__map" alt="Inheritance graph"/></div>
<map name="xmipp3_8base_8XmippProtocol_inherit__map" id="xmipp3_8base_8XmippProtocol_inherit__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7b0f8daa149c04d8d183cd7763dded25"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html#a7b0f8daa149c04d8d183cd7763dded25">convertInputToXmipp</a> (self, inputName, xmippClass, resultFn)</td></tr>
<tr class="separator:a7b0f8daa149c04d8d183cd7763dded25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3209fbd40500c5e965b8d8e5e9a9202f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html#a3209fbd40500c5e965b8d8e5e9a9202f">getConvertedInput</a> (self, inputName)</td></tr>
<tr class="separator:a3209fbd40500c5e965b8d8e5e9a9202f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed0c493783c462122981ab1b540fee5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html#a6ed0c493783c462122981ab1b540fee5">getModel</a> (cls, modelPath, kwargs)</td></tr>
<tr class="separator:a6ed0c493783c462122981ab1b540fee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2c45dcacaba699e2f9b7ce3ef68f0d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html#a6b2c45dcacaba699e2f9b7ce3ef68f0d">validateDLtoolkit</a> (self, errors=None, kwargs)</td></tr>
<tr class="separator:a6b2c45dcacaba699e2f9b7ce3ef68f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ac1edd7507466f5ef62d62fba6c303"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxmipp3_1_1base_1_1XmippProtocol.html#ac7ac1edd7507466f5ef62d62fba6c303">getCondaEnv</a> (cls, kwargs)</td></tr>
<tr class="separator:ac7ac1edd7507466f5ef62d62fba6c303"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This class groups some common functionalities that
share some Xmipp protocols, like converting steps.
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00077">77</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7b0f8daa149c04d8d183cd7763dded25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0f8daa149c04d8d183cd7763dded25">&#9670;&nbsp;</a></span>convertInputToXmipp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def xmipp3.base.XmippProtocol.convertInputToXmipp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>inputName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xmippClass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>resultFn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This step can be used whenever a conversion is needed.
It will receive the inputName and get this attribute from self,
invoke the convert function and check the result files if
conversion was done (otherwise the input was already in Xmipp format).
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00096">96</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">def </span>convertInputToXmipp(self, inputName, xmippClass, resultFn):</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; This step can be used whenever a conversion is needed.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">        It will receive the inputName and get this attribute from self,</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">        invoke the convert function and check the result files if</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">        conversion was done (otherwise the input was already in Xmipp format).</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        inputAttr = getattr(self, inputName)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        inputXmipp = xmippClass.convert(inputAttr, resultFn)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;         </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> inputXmipp <span class="keywordflow">is</span> <span class="keywordflow">not</span> inputAttr:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            self._insertChild(inputName + <span class="stringliteral">&#39;Xmipp&#39;</span>, inputXmipp)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">return</span> [resultFn]  <span class="comment"># validate resultFn was produced if converted</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         </div></div><!-- fragment -->
</div>
</div>
<a id="ac7ac1edd7507466f5ef62d62fba6c303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7ac1edd7507466f5ef62d62fba6c303">&#9670;&nbsp;</a></span>getCondaEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def xmipp3.base.XmippProtocol.getCondaEnv </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the environ corresponding to the condaEnv of the protocol.
    kwargs can contain:
       - 'env': Any environ (the xmipp one is the default)
       - '_conda_env': An installed condaEnv name
    &gt; _conda_env preference: kwargs &gt; protocol default &gt; general default
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00195">195</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">def </span>getCondaEnv(cls, **kwargs):</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; Returns the environ corresponding to the condaEnv of the protocol.</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="stringliteral">            kwargs can contain:</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="stringliteral">               - &#39;env&#39;: Any environ (the xmipp one is the default)</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="stringliteral">               - &#39;_conda_env&#39;: An installed condaEnv name</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="stringliteral">            &gt; _conda_env preference: kwargs &gt; protocol default &gt; general default</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        envName = CondaEnvManager.getCondaName(cls, **kwargs)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        env = kwargs.get(<span class="stringliteral">&#39;env&#39;</span>, <a class="code" href="classxmipp3_1_1Plugin.html#ad6558a7483ac7d425898854eb012e627">xmipp3.Plugin.getEnviron</a>())</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">return</span> CondaEnvManager.getCondaEnv(env, envName)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"># findRow() cannot go to xmipp_base (binding) because depends on emlib.metadata.Row()</span></div><div class="ttc" id="classxmipp3_1_1Plugin_html_ad6558a7483ac7d425898854eb012e627"><div class="ttname"><a href="classxmipp3_1_1Plugin.html#ad6558a7483ac7d425898854eb012e627">xmipp3.Plugin.getEnviron</a></div><div class="ttdeci">def getEnviron(cls, xmippFirst=True)</div><div class="ttdef"><b>Definition:</b> <a href="scipion-em-xmipp_2xmipp3_2____init_____8py_source.html#l00062">__init__.py:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3209fbd40500c5e965b8d8e5e9a9202f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3209fbd40500c5e965b8d8e5e9a9202f">&#9670;&nbsp;</a></span>getConvertedInput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def xmipp3.base.XmippProtocol.getConvertedInput </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>inputName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve the converted input, it can be the case that
it is the same as input, when not conversion was done.
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00109">109</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">def </span>getConvertedInput(self, inputName):</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; Retrieve the converted input, it can be the case that</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">        it is the same as input, when not conversion was done.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">return</span> getattr(self, inputName + <span class="stringliteral">&#39;Xmipp&#39;</span>, getattr(self, inputName))</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a6ed0c493783c462122981ab1b540fee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed0c493783c462122981ab1b540fee5">&#9670;&nbsp;</a></span>getModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def xmipp3.base.XmippProtocol.getModel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>modelPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the path to the models folder followed by
    the given relative path.
.../xmipp/models/myModel/myFile.h5 &lt;= getModel('myModel', 'myFile.h5')

    NOTE: it raise and exception when model not found, set doRaise=False
  in the arguments to skip that raise, especially in validation
  asserions!
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00116">116</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">def </span><a class="code" href="namespacexmipp__base.html#a3ddd695343764fa96d3ed57ebe4997b4">getModel</a>(cls, *modelPath, **kwargs):</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; Returns the path to the models folder followed by</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">            the given relative path.</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">        .../xmipp/models/myModel/myFile.h5 &lt;= getModel(&#39;myModel&#39;, &#39;myFile.h5&#39;)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">            NOTE: it raise and exception when model not found, set doRaise=False</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral">                  in the arguments to skip that raise, especially in validation</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">                  asserions!</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        os.environ[<span class="stringliteral">&#39;XMIPP_HOME&#39;</span>] = <a class="code" href="namespacexmipp3_1_1base.html#a38230922726340cf59186f50db3421cb">getXmippPath</a>()</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacexmipp__base.html#a3ddd695343764fa96d3ed57ebe4997b4">getModel</a>(*modelPath, **kwargs)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="ttc" id="namespacexmipp__base_html_a3ddd695343764fa96d3ed57ebe4997b4"><div class="ttname"><a href="namespacexmipp__base.html#a3ddd695343764fa96d3ed57ebe4997b4">xmipp_base.getModel</a></div><div class="ttdeci">def getModel(modelPath, kwargs)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__base_8py_source.html#l00327">xmipp_base.py:327</a></div></div>
<div class="ttc" id="namespacexmipp3_1_1base_html_a38230922726340cf59186f50db3421cb"><div class="ttname"><a href="namespacexmipp3_1_1base.html#a38230922726340cf59186f50db3421cb">xmipp3.base.getXmippPath</a></div><div class="ttdeci">def getXmippPath(paths)</div><div class="ttdef"><b>Definition:</b> <a href="base_8py_source.html#l00060">base.py:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b2c45dcacaba699e2f9b7ce3ef68f0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b2c45dcacaba699e2f9b7ce3ef68f0d">&#9670;&nbsp;</a></span>validateDLtoolkit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def xmipp3.base.XmippProtocol.validateDLtoolkit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>errors</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Validates if the deepLearningToolkit is installed.
    Additionally, it assert if a certain models is present when
    kwargs are present, following:
      - _conda_env: The conda env to be load
            (default: the protocol._conda_env or CONDA_DEFAULT_ENVIRON)
      - assertModel: if models should be evaluated or not (default: True).
      - errorMsg: a custom message error (default: '').
      - model: a certain model name/route/list (default: no model assert)
+ model='myModel': asserts if myModel exists
+ model=('myModel', 'myFile.h5'): asserts is myModel/myFile.h5 exists
+ model=['myModel1', 'myModel2', ('myModel3', 'myFile3.h5')]: a combination

    usage (3 examples):
      errors = validateDLtoolkit(errors, doAssert=self.useModel.get(),
                         model="myModel")

      errors = validateDLtoolkit(model=("myModel2", "myFile.h5"))

      errors = validateDLtoolkit(doAssert=self.mode.get()==PREDICT,
                         model=("myModel3", "subFolder", "model.h5"),
                         errorMsg="myModel3 is required for the "
                                  "prediction mode")
</pre> 
<p class="definition">Definition at line <a class="el" href="base_8py_source.html#l00128">128</a> of file <a class="el" href="base_8py_source.html">base.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">def </span>validateDLtoolkit(self, errors=None, **kwargs):</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; Validates if the deepLearningToolkit is installed.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral">            Additionally, it assert if a certain models is present when</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">            kwargs are present, following:</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">              - _conda_env: The conda env to be load</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">                            (default: the protocol._conda_env or CONDA_DEFAULT_ENVIRON)</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">              - assertModel: if models should be evaluated or not (default: True).</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">              - errorMsg: a custom message error (default: &#39;&#39;).</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">              - model: a certain model name/route/list (default: no model assert)</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">                + model=&#39;myModel&#39;: asserts if myModel exists</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">                + model=(&#39;myModel&#39;, &#39;myFile.h5&#39;): asserts is myModel/myFile.h5 exists</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">                + model=[&#39;myModel1&#39;, &#39;myModel2&#39;, (&#39;myModel3&#39;, &#39;myFile3.h5&#39;)]: a combination</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">            usage (3 examples):</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">              errors = validateDLtoolkit(errors, doAssert=self.useModel.get(),</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">                                         model=&quot;myModel&quot;)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">              errors = validateDLtoolkit(model=(&quot;myModel2&quot;, &quot;myFile.h5&quot;))</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">              errors = validateDLtoolkit(doAssert=self.mode.get()==PREDICT,</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">                                         model=(&quot;myModel3&quot;, &quot;subFolder&quot;, &quot;model.h5&quot;),</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">                                         errorMsg=&quot;myModel3 is required for the &quot;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">                                                  &quot;prediction mode&quot;)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment"># initialize errors if needed</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        errors = errors <span class="keywordflow">if</span> errors <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> []</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment"># Looking for the installation target for that conda environment.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        kerasError = <span class="keyword">False</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        envName = CondaEnvManager.getCondaName(self, **kwargs)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.isfile(os.path.join(pwem.Config.EM_ROOT,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                           XMIPP_DLTK_NAME,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                           envName+<span class="stringliteral">&#39;.yml&#39;</span>)):</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            errors.append(<span class="stringliteral">&quot;*%s environment not found*. &quot;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                          <span class="stringliteral">&quot;Required to run this protocol.&quot;</span> % envName)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            kerasError = <span class="keyword">True</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment"># Asserting if the model exists only if the software is well installed</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        models = kwargs.get(<span class="stringliteral">&#39;model&#39;</span>, <span class="stringliteral">&#39;&#39;</span>)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        failedModels = []</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> kerasError <span class="keywordflow">and</span> kwargs.get(<span class="stringliteral">&#39;assertModel&#39;</span>, <span class="keyword">True</span>) <span class="keywordflow">and</span> models != <span class="stringliteral">&#39;&#39;</span>:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            models = models <span class="keywordflow">if</span> isinstance(models, list) <span class="keywordflow">else</span> [models]</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">for</span> model <span class="keywordflow">in</span> models:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">if</span> isinstance(model, str):</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    modelFn = self.getModel(model, doRaise=<span class="keyword">False</span>)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    modelName = model.split(<span class="stringliteral">&#39;/&#39;</span>)[0]  <span class="comment"># This differs from dirname</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">elif</span> isinstance(model, tuple):</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    modelFn = self.getModel(*model, doRaise=<span class="keyword">False</span>)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    modelName = model[0]</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    print(<span class="stringliteral">&quot;Deep Learning model type unknown (%s validation):\n&quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                          <span class="stringliteral">&quot; &gt; %s %s&quot;</span> % (self, model, <a class="code" href="namespacebatch__classify__pca.html#a9879581202dcd0655283de8087182d89">type</a>(model)))</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    <span class="keywordflow">continue</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(modelFn):</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    failedModels.append(modelName)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> failedModels:</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                errors.append(<span class="stringliteral">&quot;*Pre-trained model(s) not found*: %s&quot;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                              % <span class="stringliteral">&#39;, &#39;</span>.join(failedModels))</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment"># Hint to install the deepLearningToolkit</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> kerasError <span class="keywordflow">or</span> failedModels:</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            errors.append(<span class="stringliteral">&quot;Please, *run* &#39;scipion installb deepLearningToolkit&#39; &quot;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                          <span class="stringliteral">&quot;or install the scipion-em-xmipp &gt; deepLearningToolkit &quot;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                          <span class="stringliteral">&quot;package using the *plugin manager*.&quot;</span>)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> errors</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="ttc" id="namespacebatch__classify__pca_html_a9879581202dcd0655283de8087182d89"><div class="ttname"><a href="namespacebatch__classify__pca.html#a9879581202dcd0655283de8087182d89">batch_classify_pca.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="batch__classify__pca_8py_source.html#l00058">batch_classify_pca.py:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scipion-em-xmipp/xmipp3/<a class="el" href="base_8py_source.html">base.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
